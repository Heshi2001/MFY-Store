{% extends "store/base.html" %}
{% load static %}

{% block title %}FAQ | MFY Store{% endblock %}

{% block content %}

<main class="relative z-10">
  <!-- FAQ Section -->
  <section 
    class="max-w-4xl mx-auto px-4 pt-40 pb-10 md:pt-42 md:pb-12 text-gray-100" 
    x-data="faqPage()"
  >
    <!-- Heading -->
    <div class="text-center mb-8">
      <h1 class="text-3xl md:text-4xl font-bold text-green-400 mb-3 animate-fade-in">
        Frequently Asked Questions
      </h1>
      <p class="text-gray-400 max-w-2xl mx-auto text-sm sm:text-base">
        Find quick answers to the most common questions about MFY Store.
      </p>
    </div>

    <!-- Search box with auto-suggest -->
    <div class="relative mb-10 max-w-md mx-auto">
      <input 
        type="text"
        x-model="searchQuery"
        x-on:input="filterFAQs"
        placeholder="Search your question..."
        class="w-full px-4 py-3 bg-gray-900 border border-gray-800 rounded-xl focus:ring-2 focus:ring-green-500 focus:outline-none text-gray-100 placeholder-gray-500 transition-all duration-200"
      />
      <div 
        x-show="suggestions.length > 0"
        class="absolute z-10 w-full bg-gray-800 border border-gray-700 mt-2 rounded-xl shadow-lg overflow-hidden"
      >
        <template x-for="(suggestion, index) in suggestions" :key="index">
          <div 
            @click="selectSuggestion(suggestion)" 
            class="px-4 py-2 hover:bg-green-600 hover:text-white cursor-pointer text-sm text-gray-300 transition-all duration-150"
          >
            <span x-text="suggestion"></span>
          </div>
        </template>
      </div>
    </div>

    <!-- FAQ List -->
    <div class="space-y-3 md:space-y-4" id="faq-container">
      {% for faq in faqs %}
      <div 
        class="bg-gray-900 rounded-2xl border border-gray-800 overflow-hidden transition-all hover:border-green-500 animate-slide-up"
        x-data="{ open: false }"
      >
        <button 
          @click="open = !open"
          class="w-full flex justify-between items-center p-5 text-left focus:outline-none group"
        >
          <div class="flex items-center gap-3">
            <svg xmlns="http://www.w3.org/2000/svg" 
                 class="w-5 h-5 text-green-400 group-hover:scale-110 transition-transform" 
                 fill="none" 
                 viewBox="0 0 24 24" 
                 stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 10h8M8 14h6m-3-9a9 9 0 100 18 9 9 0 000-18z" />
            </svg>
            <span class="text-lg font-semibold group-hover:text-green-400 transition-colors">
              {{ faq.question }}
            </span>
          </div>
          <i 
            class="fa-solid fa-chevron-down text-gray-400 transition-all duration-300"
            :class="{ 'rotate-180 text-green-400': open }"
          ></i>
        </button>
        <div 
          x-show="open"
          x-collapse
          class="px-5 pb-5 text-gray-300 text-sm leading-relaxed"
        >
          {{ faq.answer|linebreaks }}
        </div>
      </div>
      {% empty %}
      <div class="text-center mt-12 animate-fade-in">
        <img src="{% static 'store/images/empty-faq.svg' %}" class="w-36 h-36 mx-auto opacity-80 animate-float" alt="No FAQs">
        <p class="text-gray-400 mt-3 text-sm">No FAQs available at the moment.</p>
      </div>
      {% endfor %}
    </div>

    <!-- Go Home Button -->
    <div class="text-center my-10">
      <a href="{% url 'index' %}" 
         class="inline-flex items-center gap-2 bg-green-600 hover:bg-green-700 text-white font-medium px-6 py-3 rounded-full transition-all duration-300 shadow-md hover:shadow-green-500/30">
        <i class="fa fa-home"></i> Go to Home
      </a>
    </div>
  </section>
</main>

<!-- Floating WhatsApp / Live Chat -->
<a href="https://wa.me/{{ whatsapp_number|default:'+919876543210' }}"
   target="_blank"
   class="fixed bottom-6 right-6 flex items-center gap-2 bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-full shadow-lg transition-all duration-300 animate-fade-in">
  <i class="fa-brands fa-whatsapp text-xl animate-pulse"></i>
  <span class="hidden sm:inline text-sm font-medium">Chat with us</span>
</a>

{% endblock %}

{% block extra_js %}
{{ block.super }}
<script src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
<script>
function faqPage() {
  return {
    searchQuery: '',
    suggestions: [],
    filterFAQs() {
      const query = this.searchQuery.toLowerCase();
      this.suggestions = [];
      document.querySelectorAll('#faq-container > div').forEach(faq => {
        const question = faq.querySelector('span').innerText.toLowerCase();
        faq.style.display = question.includes(query) ? 'block' : 'none';
        if (question.includes(query) && query.length > 0) {
          this.suggestions.push(faq.querySelector('span').innerText);
        }
      });
    },
    selectSuggestion(text) {
      this.searchQuery = text;
      this.filterFAQs();
      this.suggestions = [];
    }
  }
}
</script>

<!-- Subtle Animations -->
<style>
@keyframes float { 0%,100%{transform:translateY(0);} 50%{transform:translateY(-5px);} }
.animate-float { animation: float 3s ease-in-out infinite; }
@keyframes fadeIn { from{opacity:0;transform:translateY(10px);} to{opacity:1;transform:translateY(0);} }
.animate-fade-in { animation: fadeIn 0.6s ease-out forwards; }
@keyframes slideUp { from{opacity:0;transform:translateY(15px);} to{opacity:1;transform:translateY(0);} }
.animate-slide-up { animation: slideUp 0.6s ease-out both; }
</style>
{% endblock %}
